This example makes it possible to serialize and deserialize objects without using reflection or introspection at runtime.

It achieves that in two parts: first it creates providers for every class marked with the [JsonSerializable](JsonSerializable.php)
attribute and then assigns them to a partial method in the [JsonSerializer](JsonSerializer.php#L39).

The usage is very simple:

```php
<?php

use App\JsonSerializer;
use App\ObjectToSerialize;

$serializer = new JsonSerializer();
$objectToSerialize = new ObjectToSerialize('hello');
$serializedArray = $serializer->serialize($objectToSerialize);

echo json_encode($serializedArray, JSON_PRETTY_PRINT | JSON_UNESCAPED_SLASHES);
```

The above prints something like (see the [ObjectToSerialize](ObjectToSerialize.php) for yourself): 

```json
{
    "test1": "hello",
    "test2": "world",
    "renamedProperty": 3,
    "version": "8.4.3"
}
```

The reverse is also possible:

```php
<?php

$serializer = new JsonSerializer();
$rawJson = <<<'JSON'
{
    "test1": "hello",
    "test2": "there",
    "renamedProperty": 5,
    "version": "7.0.0"
}
JSON;
$array = json_decode($rawJson, true);
$object = $serializer->deserialize($array, ObjectToSerialize::class);
var_dump($object);
```

This prints:

```
object(App\ObjectToSerialize)#8 (4) {
  ["test1"]=>
  string(5) "hello"
  ["test2"]=>
  string(5) "there"
  ["test3"]=>
  int(5)
  ["version"]=>
  string(5) "7.0.0"
}
```

---

Here are the classes generated by the source generator (I've added some line breaks manually for readability):

```php
<?php

declare (strict_types=1);
namespace App;

final readonly class ObjectToSerializeSerializationProvider implements \App\SerializationProvider
{
    public function serialize(object $object): array
    {
        if (!$object instanceof \App\ObjectToSerialize) {
            throw new \LogicException('This provider only supports instances of \'App\ObjectToSerialize\', ' . get_debug_type($object) . ' given');
        }
        return [
            'test1' => $object->test1,
            'test2' => $object->test2,
            'renamedProperty' => $object->test3,
            'version' => $object->version,
        ];
    }
    public function deserialize(array $data): \App\ObjectToSerialize
    {
        return new \App\ObjectToSerialize(
            test1: $data['test1'] ?? throw new \InvalidArgumentException('The \'test1\' key is required when deserializing objects of type \'App\ObjectToSerialize\''),
            test2: $data['test2'] ?? 'world',
            test3: $data['renamedProperty'] ?? 3,
            version: $data['version'] ?? \PHP_VERSION,
        );
    }
}
```

```php
<?php

declare (strict_types=1);
namespace App;

final readonly class AnotherObjectToSerializeSerializationProvider implements \App\SerializationProvider
{
    public function serialize(object $object): array
    {
        if (!$object instanceof \App\AnotherObjectToSerialize) {
            throw new \LogicException('This provider only supports instances of \'App\AnotherObjectToSerialize\', ' . get_debug_type($object) . ' given');
        }
        return [
            'value1' => $object->value1,
            'value2' => $object->value2,
        ];
    }
    public function deserialize(array $data): \App\AnotherObjectToSerialize
    {
        return new \App\AnotherObjectToSerialize(
            value1: $data['value1'] ?? throw new \InvalidArgumentException('The \'value1\' key is required when deserializing objects of type \'App\AnotherObjectToSerialize\''),
            value2: $data['value2'] ?? throw new \InvalidArgumentException('The \'value2\' key is required when deserializing objects of type \'App\AnotherObjectToSerialize\''),
        );
    }
}
```

And the class [JsonSerializer](JsonSerializer.php) has only the following method implemented by a source generator,
everything else stays the same as in the original:

```php
    /**
     * @return iterable<string, SerializationProvider<object>>
     */
    private function getProviders(): iterable
    {
        yield 'App\ObjectToSerialize' => new \App\ObjectToSerializeSerializationProvider();
        yield 'App\AnotherObjectToSerialize' => new \App\AnotherObjectToSerializeSerializationProvider();
    }
```
